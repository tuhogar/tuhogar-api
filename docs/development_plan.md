# Plano de Desenvolvimento

Este documento contém o plano detalhado para o desenvolvimento do sistema tuhogar-api. Cada tarefa inclui uma estimativa de tempo em horas e pode ser marcada como concluída quando finalizada.

## Legenda
- [ ] Tarefa pendente
- [x] Tarefa concluída

## 1. Desenvolvimento de diagrama de classes de todos os módulos do sistema

### 1.1. Módulo: Gerenciamento de Usuários

#### Registro de novos usuários
- [x] 1.1.1. Criar diagrama de caso de uso para Registro de novos usuários (2h)
- [x] 1.1.2. Criar diagrama de classes para Registro de novos usuários (3h)
- [x] 1.1.3. Criar diagrama de sequência para Registro de novos usuários (2.5h)

#### Autenticação de usuários (login)
- [x] 1.1.4. Criar diagrama de caso de uso para Autenticação de usuários (1.5h)
- [x] 1.1.5. Criar diagrama de classes para Autenticação de usuários (2.5h)
- [x] 1.1.6. Criar diagrama de sequência para Autenticação de usuários (2h)

#### Atualização de dados de usuários
- [x] 1.1.7. Criar diagrama de caso de uso para Atualização de dados de usuários (1.5h)
- [x] 1.1.8. Criar diagrama de classes para Atualização de dados de usuários (2h)
- [x] 1.1.9. Criar diagrama de sequência para Atualização de dados de usuários (2h)

#### Recuperação de senha
- [x] 1.1.10. Criar diagrama de caso de uso para Recuperação de senha (1.5h)
- [x] 1.1.11. Criar diagrama de classes para Recuperação de senha (2h)
- [x] 1.1.12. Criar diagrama de sequência para Recuperação de senha (2h)

#### Controle de níveis de acesso por perfis
- [x] 1.1.13. Criar diagrama de caso de uso para Controle de níveis de acesso (1.5h)
- [x] 1.1.14. Criar diagrama de classes para Controle de níveis de acesso (2h)
- [x] 1.1.15. Criar diagrama de sequência para Controle de níveis de acesso (1.5h)

#### Gerenciamento de usuários favoritos
- [x] 1.1.16. Criar diagrama de caso de uso para Gerenciamento de usuários favoritos (1.5h)
- [x] 1.1.17. Criar diagrama de classes para Gerenciamento de usuários favoritos (2h)
- [x] 1.1.18. Criar diagrama de sequência para Gerenciamento de usuários favoritos (2h)

#### Exclusão de usuários
- [x] 1.1.19. Criar diagrama de caso de uso para Exclusão de usuários (1h)
- [x] 1.1.20. Criar diagrama de classes para Exclusão de usuários (1.5h)
- [x] 1.1.21. Criar diagrama de sequência para Exclusão de usuários (1.5h)

#### Atualização de status de usuários
- [x] 1.1.22. Criar diagrama de caso de uso para Atualização de status de usuários (1h)
- [x] 1.1.23. Criar diagrama de classes para Atualização de status de usuários (1.5h)
- [x] 1.1.24. Criar diagrama de sequência para Atualização de status de usuários (1.5h)

### 1.2. Módulo: Gerenciamento de Contas

#### Criação de contas
- [x] 1.2.1. Criar diagrama de caso de uso para Criação de contas (1.5h)
- [x] 1.2.2. Criar diagrama de classes para Criação de contas (2.5h)
- [x] 1.2.3. Criar diagrama de sequência para Criação de contas (2h)

#### Atualização de informações da conta
- [x] 1.2.4. Criar diagrama de caso de uso para Atualização de informações da conta (1.5h)
- [x] 1.2.5. Criar diagrama de classes para Atualização de informações da conta (2h)
- [x] 1.2.6. Criar diagrama de sequência para Atualização de informações da conta (2h)

#### Consulta de dados da conta
- [x] 1.2.7. Criar diagrama de caso de uso para Consulta de dados da conta (1h)
- [x] 1.2.8. Criar diagrama de classes para Consulta de dados da conta (1.5h)
- [x] 1.2.9. Criar diagrama de sequência para Consulta de dados da conta (1.5h)

#### Processamento de imagens da conta
- [x] 1.2.10. Criar diagrama de caso de uso para Processamento de imagens da conta (1.5h)
- [x] 1.2.11. Criar diagrama de classes para Processamento de imagens da conta (2h)
- [x] 1.2.12. Criar diagrama de sequência para Processamento de imagens da conta (2h)

#### Exclusão de imagens da conta
- [x] 1.2.13. Criar diagrama de caso de uso para Exclusão de imagens da conta (1h)
- [x] 1.2.14. Criar diagrama de classes para Exclusão de imagens da conta (1.5h)
- [x] 1.2.15. Criar diagrama de sequência para Exclusão de imagens da conta (1.5h)

#### Atualização de status da conta
- [x] 1.2.16. Criar diagrama de caso de uso para Atualização de status da conta (1h)
- [x] 1.2.17. Criar diagrama de classes para Atualização de status da conta (1.5h)
- [x] 1.2.18. Criar diagrama de sequência para Atualização de status da conta (1.5h)

#### Exclusão de usuário da conta
- [x] 1.2.19. Criar diagrama de caso de uso para Exclusão de usuário da conta (1h)
- [x] 1.2.20. Criar diagrama de classes para Exclusão de usuário da conta (1.5h)
- [x] 1.2.21. Criar diagrama de sequência para Exclusão de usuário da conta (1.5h)

#### Busca de contas inativas
- [x] 1.2.22. Criar diagrama de caso de uso para Busca de contas inativas (1h)
- [x] 1.2.23. Criar diagrama de classes para Busca de contas inativas (1.5h)
- [x] 1.2.24. Criar diagrama de sequência para Busca de contas inativas (1.5h)

### 1.3. Módulo: Anúncios Imobiliários

#### Criação de anúncios
- [ ] 1.3.1. Criar diagrama de caso de uso para Criação de anúncios (2h)
- [ ] 1.3.2. Criar diagrama de classes para Criação de anúncios (3h)
- [ ] 1.3.3. Criar diagrama de sequência para Criação de anúncios (2.5h)

#### Edição de anúncios
- [ ] 1.3.4. Criar diagrama de caso de uso para Edição de anúncios (1.5h)
- [ ] 1.3.5. Criar diagrama de classes para Edição de anúncios (2.5h)
- [ ] 1.3.6. Criar diagrama de sequência para Edição de anúncios (2h)

#### Exclusão de anúncios
- [ ] 1.3.7. Criar diagrama de caso de uso para Exclusão de anúncios (1h)
- [ ] 1.3.8. Criar diagrama de classes para Exclusão de anúncios (1.5h)
- [ ] 1.3.9. Criar diagrama de sequência para Exclusão de anúncios (1.5h)

#### Moderação de anúncios (aprovação/rejeição)
- [ ] 1.3.10. Criar diagrama de caso de uso para Moderação de anúncios (1.5h)
- [ ] 1.3.11. Criar diagrama de classes para Moderação de anúncios (2h)
- [ ] 1.3.12. Criar diagrama de sequência para Moderação de anúncios (2h)

#### Upload e gerenciamento de imagens para anúncios
- [ ] 1.3.13. Criar diagrama de caso de uso para Upload e gerenciamento de imagens (1.5h)
- [ ] 1.3.14. Criar diagrama de classes para Upload e gerenciamento de imagens (2.5h)
- [ ] 1.3.15. Criar diagrama de sequência para Upload e gerenciamento de imagens (2h)

#### Controle de status dos anúncios
- [ ] 1.3.16. Criar diagrama de caso de uso para Controle de status dos anúncios (1.5h)
- [ ] 1.3.17. Criar diagrama de classes para Controle de status dos anúncios (2h)
- [ ] 1.3.18. Criar diagrama de sequência para Controle de status dos anúncios (2h)

#### Transferência de anúncios entre contas
- [ ] 1.3.19. Criar diagrama de caso de uso para Transferência de anúncios (1.5h)
- [ ] 1.3.20. Criar diagrama de classes para Transferência de anúncios (2h)
- [ ] 1.3.21. Criar diagrama de sequência para Transferência de anúncios (2h)

#### Busca avançada de anúncios
- [ ] 1.3.22. Criar diagrama de caso de uso para Busca avançada de anúncios (1.5h)
- [ ] 1.3.23. Criar diagrama de classes para Busca avançada de anúncios (2.5h)
- [ ] 1.3.24. Criar diagrama de sequência para Busca avançada de anúncios (2h)

#### Busca de imóveis similares
- [ ] 1.3.25. Criar diagrama de caso de uso para Busca de imóveis similares (1.5h)
- [ ] 1.3.26. Criar diagrama de classes para Busca de imóveis similares (2h)
- [ ] 1.3.27. Criar diagrama de sequência para Busca de imóveis similares (2h)

#### Obtenção de localizações de anúncios
- [ ] 1.3.28. Criar diagrama de caso de uso para Obtenção de localizações de anúncios (1h)
- [ ] 1.3.29. Criar diagrama de classes para Obtenção de localizações de anúncios (1.5h)
- [ ] 1.3.30. Criar diagrama de sequência para Obtenção de localizações de anúncios (1.5h)

#### Atualização em massa de anúncios
- [ ] 1.3.31. Criar diagrama de caso de uso para Atualização em massa de anúncios (1.5h)
- [ ] 1.3.32. Criar diagrama de classes para Atualização em massa de anúncios (2h)
- [ ] 1.3.33. Criar diagrama de sequência para Atualização em massa de anúncios (2h)

### 1.4. Módulo: Assinaturas e Pagamentos

#### Criação de assinaturas
- [ ] 1.4.1. Criar diagrama de caso de uso para Criação de assinaturas (2h)
- [ ] 1.4.2. Criar diagrama de classes para Criação de assinaturas (3h)
- [ ] 1.4.3. Criar diagrama de sequência para Criação de assinaturas (2.5h)

#### Processamento de pagamentos recorrentes
- [ ] 1.4.4. Criar diagrama de caso de uso para Processamento de pagamentos recorrentes (2h)
- [ ] 1.4.5. Criar diagrama de classes para Processamento de pagamentos recorrentes (2.5h)
- [ ] 1.4.6. Criar diagrama de sequência para Processamento de pagamentos recorrentes (2.5h)

#### Gerenciamento de status das assinaturas
- [ ] 1.4.7. Criar diagrama de caso de uso para Gerenciamento de status das assinaturas (1.5h)
- [ ] 1.4.8. Criar diagrama de classes para Gerenciamento de status das assinaturas (2h)
- [ ] 1.4.9. Criar diagrama de sequência para Gerenciamento de status das assinaturas (2h)

#### Recebimento e processamento de notificações de pagamento
- [ ] 1.4.10. Criar diagrama de caso de uso para Recebimento e processamento de notificações (2h)
- [ ] 1.4.11. Criar diagrama de classes para Recebimento e processamento de notificações (2.5h)
- [ ] 1.4.12. Criar diagrama de sequência para Recebimento e processamento de notificações (2.5h)

#### Atualização de planos de assinatura
- [ ] 1.4.13. Criar diagrama de caso de uso para Atualização de planos de assinatura (1.5h)
- [ ] 1.4.14. Criar diagrama de classes para Atualização de planos de assinatura (2h)
- [ ] 1.4.15. Criar diagrama de sequência para Atualização de planos de assinatura (2h)

#### Cancelamento de assinaturas
- [ ] 1.4.16. Criar diagrama de caso de uso para Cancelamento de assinaturas (1.5h)
- [ ] 1.4.17. Criar diagrama de classes para Cancelamento de assinaturas (2h)
- [ ] 1.4.18. Criar diagrama de sequência para Cancelamento de assinaturas (2h)

#### Criação de assinaturas internas
- [ ] 1.4.19. Criar diagrama de caso de uso para Criação de assinaturas internas (1.5h)
- [ ] 1.4.20. Criar diagrama de classes para Criação de assinaturas internas (2h)
- [ ] 1.4.21. Criar diagrama de sequência para Criação de assinaturas internas (2h)

### 1.5. Módulo: Planos

#### Criação de planos
- [ ] 1.5.1. Criar diagrama de caso de uso para Criação de planos (1.5h)
- [ ] 1.5.2. Criar diagrama de classes para Criação de planos (2h)
- [ ] 1.5.3. Criar diagrama de sequência para Criação de planos (2h)

#### Atualização de planos
- [ ] 1.5.4. Criar diagrama de caso de uso para Atualização de planos (1.5h)
- [ ] 1.5.5. Criar diagrama de classes para Atualização de planos (2h)
- [ ] 1.5.6. Criar diagrama de sequência para Atualização de planos (2h)

#### Consulta de planos
- [ ] 1.5.7. Criar diagrama de caso de uso para Consulta de planos (1h)
- [ ] 1.5.8. Criar diagrama de classes para Consulta de planos (1.5h)
- [ ] 1.5.9. Criar diagrama de sequência para Consulta de planos (1.5h)

#### Desativação de planos
- [ ] 1.5.10. Criar diagrama de caso de uso para Desativação de planos (1h)
- [ ] 1.5.11. Criar diagrama de classes para Desativação de planos (1.5h)
- [ ] 1.5.12. Criar diagrama de sequência para Desativação de planos (1.5h)

### 1.6. Módulo: Eventos de Imóveis (Advertisement Events)

#### Registro de eventos de anúncios
- [x] 1.6.1. Criar diagrama de caso de uso para Registro de eventos de anúncios (1.5h)
- [x] 1.6.2. Criar diagrama de classes para Registro de eventos de anúncios (2h)
- [x] 1.6.3. Criar diagrama de sequência para Registro de eventos de anúncios (2h)

#### Geração de relatórios estatísticos mensais
- [x] 1.6.4. Criar diagrama de caso de uso para Geração de relatórios estatísticos mensais (1.5h)
- [x] 1.6.5. Criar diagrama de classes para Geração de relatórios estatísticos mensais (2h)
- [x] 1.6.6. Criar diagrama de sequência para Geração de relatórios estatísticos mensais (2h)

### 1.7. Módulo: Amenidades e Tipos de Contrato

#### Gerenciamento de amenidades
- [ ] 1.7.1. Criar diagrama de caso de uso para Gerenciamento de amenidades (1.5h)
- [ ] 1.7.2. Criar diagrama de classes para Gerenciamento de amenidades (2h)
- [ ] 1.7.3. Criar diagrama de sequência para Gerenciamento de amenidades (2h)

#### Gerenciamento de tipos de contrato
- [ ] 1.7.4. Criar diagrama de caso de uso para Gerenciamento de tipos de contrato (1.5h)
- [ ] 1.7.5. Criar diagrama de classes para Gerenciamento de tipos de contrato (2h)
- [ ] 1.7.6. Criar diagrama de sequência para Gerenciamento de tipos de contrato (2h)

### 1.8. Módulo: Integrações

#### Integração com Firebase
- [ ] 1.8.1. Criar diagrama de caso de uso para Integração com Firebase (1.5h)
- [ ] 1.8.2. Criar diagrama de classes para Integração com Firebase (2h)
- [ ] 1.8.3. Criar diagrama de sequência para Integração com Firebase (2h)

#### Integração com ePayco
- [ ] 1.8.4. Criar diagrama de caso de uso para Integração com ePayco (1.5h)
- [ ] 1.8.5. Criar diagrama de classes para Integração com ePayco (2h)
- [ ] 1.8.6. Criar diagrama de sequência para Integração com ePayco (2h)


## 2. Desenvolvimento da funcionalidade de geração de relatórios estatíticos mensais de imóveis

### 2.1. Domínio

#### Entidades de Domínio
- [x] 2.1.1. Criar entidade AccountAdvertisementStatistics (1.5h)
- [x] 2.1.2. Criar entidades de métricas (TotalAdvertisements, TotalVisits, PhoneClicks, etc.) (2h)
- [x] 2.1.3. Criar entidades para segmentação (TransactionTypeMetrics, PropertyTypeAndTransactionMetrics) (1.5h)
- [x] 2.1.4. Criar entidades para rankings (TopAdvertisements, AdvertisementMetric) (1h)
- [x] 2.1.5. Implementar validações de domínio (1h)

#### Interfaces de Repositório
- [x] 2.1.6. Definir interface IAccountAdvertisementStatisticsRepository (1h)
- [x] 2.1.7. Atualizar interfaces existentes (IAdvertisementEventRepository, IAdvertisementRepository, IAccountRepository) se necessário (1h)

### 2.2. Aplicação

#### Casos de Uso
- [x] 2.2.1. Implementar GenerateMonthlyStatisticsUseCase (3h)
- [x] 2.2.2. Implementar GetAccountStatisticsUseCase (2h)
- [x] 2.2.3. Implementar testes unitários para os casos de uso (2h)

#### Interfaces de Comando
- [x] 2.2.4. Criar interface GetAccountStatisticsUseCaseCommand para entrada do caso de uso (0.5h)
- [x] 2.2.5. Garantir que os casos de uso retornem entidades de domínio diretamente (0.5h)

### 2.3. Infraestrutura

#### Persistência
- [x] 2.3.1. Criar schema Mongoose para AccountAdvertisementStatistics (1.5h)
- [x] 2.3.2. Implementar MongooseAccountAdvertisementStatisticsRepository (2h)
- [ ] 2.3.3. Implementar testes de integração para o repositório (1.5h) - *Nota: Decidiu-se focar nos testes de use cases, controllers e mappers, removendo a necessidade de testes de integração para repositórios.*

#### Scheduler
- [x] 2.3.4. Implementar agendamento diretamente no caso de uso (1h)
- [x] 2.3.5. Configurar agendamento via variável de ambiente (1.5h)
- [x] 2.3.6. Implementar tratamento de erros para continuar processamento em caso de falha (1h)

#### Mappers
- [x] 2.3.7. Criar AccountAdvertisementStatisticsMapper para conversão entre entidade de domínio e modelo de persistência (1.5h)
- [x] 2.3.8. Implementar testes para os mappers (1h)

### 2.4. Interface

#### Controllers
- [x] 2.4.1. Implementar AdvertisementStatisticsController para consulta de estatísticas (1.5h)
- [x] 2.4.2. Implementar validação de entrada e autorização (1h)
- [x] 2.4.3. Implementar testes para os controllers (1h)
- [x] 2.4.4. Refatorar endpoints para ter um GET para listar todos os relatórios e um GET /:month para buscar relatório específico (1h)
- [x] 2.4.5. Adicionar permissão MASTER e parâmetro accountId ao endpoint de listagem de estatísticas (1h)
- [x] 2.4.6. Implementar validação do parâmetro accountId para usuários MASTER diretamente no controller (0.5h)

### 2.5. Configuração e Integração

#### Módulos
- [x] 2.5.1. Integrar com módulos existentes (http.module.ts e mongoose.module.ts) (1h)
- [x] 2.5.2. Registrar controllers, use-cases e repositórios nos módulos apropriados (0.5h)

#### Documentação de Configuração
- [x] 2.5.3. Atualizar documentação de configuração (0.5h)

### 2.6. Testes

#### Testes de Integração
- [ ] 2.6.1. Implementar testes de integração para o fluxo completo (2h) - *Nota: Decidiu-se focar apenas nos testes unitários nesta fase do projeto. Testes de integração poderão ser implementados em uma fase posterior, se necessário.*

#### Testes E2E
- [ ] 2.6.2. Implementar testes E2E para os endpoints de estatísticas (2h) - *Nota: Decidiu-se focar apenas nos testes unitários nesta fase do projeto. Testes E2E poderão ser implementados em uma fase posterior, se necessário.*

### 2.7. Documentação

#### Documentação Técnica
- [x] 2.7.1. Criar documentação técnica da funcionalidade (1h)
